<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Katalog Battery Profesional</title>

<style>
body{
  font-family:Arial, sans-serif;
  margin:0;
  background:#f4f6f8;
}

.header{
  background:#2eaf55;
  color:#fff;
  text-align:center;
  padding:14px;
  font-weight:bold;
}

.search{
  padding:10px;
  background:#fff;
}

.search input{
  width:100%;
  padding:12px;
  border-radius:8px;
  border:1px solid #ccc;
}

.list{
  padding:10px;
}

.item{
  background:#fff;
  border-radius:8px;
  padding:10px;
  margin-bottom:8px;
  display:flex;
  align-items:center;
  gap:10px;
}

.item input{
  transform:scale(1.2);
}

.nama{
  font-weight:bold;
}

.harga{
  color:#2eaf55;
  font-size:14px;
}

.wa{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  padding:14px;
  border:none;
  background:#25d366;
  color:#fff;
  font-size:16px;
}
</style>
</head>

<body>

<div class="header">ðŸ”‹ Katalog Battery Profesional</div>

<div class="search">
  <input type="text" id="cari" placeholder="Cari Battery (contoh: iPhone X)" onkeyup="filter()">
</div>

<div id="list" class="list">Loading data...</div>

<button class="wa" onclick="kirimWA()">ðŸ›’ Kirim ke WhatsApp</button>

<script>
const batterySelected = new Set();
let batteryData = [];

const BATTERY_CSV =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vR-bDX_S5Cwma6e7vlf8Of4XVwccJ9ukNFZODZg08gqRgjaK7gCN5xMIFIgMgAbgXw44dz8BrinQBBR/pub?gid=15483237&single=true&output=csv";

fetch(BATTERY_CSV)
.then(r=>r.text())
.then(t=>{
  const rows = t.split("\n").slice(1);
  batteryData = rows.map(r=>r.split(",")).filter(r=>r[0]);
  renderBattery(batteryData);
});

function renderBattery(arr){
  let html="";
  arr.forEach(r=>{
    const nama=r[0];
    const harga=r[1]||"-";
    const key=nama+"|"+harga;

    html+=`
    <div class="item">
      <input type="checkbox"
        ${batterySelected.has(key)?"checked":""}
        onchange="
          this.checked
            ? batterySelected.add('${key}')
            : batterySelected.delete('${key}')
        "
      >
      <div>
        <div class="nama">${nama}</div>
        <div class="harga">${harga}</div>
      </div>
    </div>`;
  });
  document.getElementById("list").innerHTML=html;
}

function filterBattery(){
  const q=document.getElementById("cari").value.toLowerCase();
  renderBattery(batteryData.filter(r=>r[0].toLowerCase().includes(q)));
}

function kirimBattery(){
  if(!batterySelected.size) return alert("Pilih battery dulu");
  let total=0, pesan="ðŸ§¾ *NOTA BATTERY*\n\n", i=1;

  batterySelected.forEach(k=>{
    const [n,h]=k.split("|");
    const harga=parseInt(h.replace(/\D/g,""))||0;
    total+=harga;
    pesan+=`${i}. ${n}\n   Rp ${harga.toLocaleString("id-ID")}\n\n`;
    i++;
  });

  pesan+=`TOTAL: Rp ${total.toLocaleString("id-ID")}`;
  location.href="https://wa.me/6282319264646?text="+encodeURIComponent(pesan);
}
</script>
</body>
</html>