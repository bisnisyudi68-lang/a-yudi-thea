<script>
const sheetId = "136iuN-tMhDZk89YsVecnDEKJOfQlL6A3AImhIGmILKc";
const sheetName = "Stock Konter";

const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;

fetch(url)
.then(res => res.text())
.then(txt => {
const json = JSON.parse(txt.substring(47).slice(0, -2));
const rows = json.table.rows;

window.data = rows.map(r => ({
Kode: r.c[0]?.v || "",
Nama: r.c[1]?.v || "",
Harga: r.c[4]?.v || "",
Sisa: r.c[6]?.v || ""
}));

tampil(window.data);
});

function tampil(d){
hasil.innerHTML="";
d.forEach(p=>{
if(p.Sisa>0){
hasil.innerHTML+=`
<div class="card">
<b>${p.Kode}</b><br>
${p.Nama}<br>
<span class="harga">Rp ${p.Harga}</span><br>
Stok: ${p.Sisa}
</div>`;
}
});
}

function filter(){
let q=cari.value.toLowerCase();
let f=data.filter(p=>
p.Kode.toLowerCase().includes(q) ||
p.Nama.toLowerCase().includes(q)
);
tampil(f);
}
</script>